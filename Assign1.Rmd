---
title: "Assignment"
output: html_document
---

### Part (I): Load Data

```{r}
library(RWeka)
library(caret)
df <- read.csv("sonar.all-data")

```

### Part (II): Evaluate Decision Tree model
#### A model is created using J48 method from the RWeka library which implements the C4.5 algorithm for decision trees. Since in this part we want to evaluate the model once without cross validation and once with 10-folds cross validation on the same training dataset, the evaluate method could be used with specifying the numFolds and outputting a summary of the evaluation metrics as well as the confusion matrix.

```{r}
sonar_j48 <- J48(R ~ ., data = df)


evaluate_Weka_classifier(sonar_j48, numFolds = 0, complexity = FALSE, 
                                     class = TRUE)

evaluate_Weka_classifier(sonar_j48, numFolds = 10, complexity = FALSE, 
                                     class = TRUE)

```

### Part (III):
#### Here we want to compare the performance of the different classifiers. after each classifier we print the Sensitivity which is equal to the recall of the first class, Positive Predictive Value is the Precision

```{r warning=FALSE, message=FALSE }
mymat = matrix(nrow=4, ncol=4)

for(i in 1:dim(mymat)[1])  
{
	if(i==1){
	m <- "rf"
	}else if(i==2){
	m <- "nb"
	}else if(i==3){
	m <- "nnet"
	}else if(i==4){
	m <- "svmLinear"
	}
	split=0.80
trainIndex <- createDataPartition(df$R, p=split, list=FALSE)
data_train <- df[ trainIndex,]
data_test <- df[-trainIndex,]
train_control <- trainControl(method="cv", number=10)
model <- train(R~., data=data_train, trControl=train_control, method=m)
p <- predict(model,newdata = data_test[,1:60])
t <- table(p , data_test[,61])
cm <- confusionMatrix(t)
acc <- cm$overall['Accuracy']
precision <- cm$byClass['Pos Pred Value'] 
recall <- cm$byClass['Sensitivity']
f_measure <- 2 * ((precision * recall) / (precision + recall))
  for(j in 1:dim(mymat)[2]) # for each column
  {
    mymat[i,1] = acc
    mymat[i,2] = precision
    mymat[i,3] = recall
    mymat[i,4] = f_measure
  }
}
colnames(mymat) <- c('accuracy','precision','recall','f_measure')
rownames(mymat) <- c('random.forest', 'naive.bayes','neural.network','svm')
mytable <- as.table(mymat)
mytable
```

